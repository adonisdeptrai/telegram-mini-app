<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Shop Mini App</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #ffffff;
            min-height: 100vh;
            padding-bottom: 70px;
        }
        
        .container {
            max-width: 500px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Header Styles */
        .user-header {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        
        .user-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .user-name {
            font-size: 18px;
            font-weight: 600;
        }
        
        .balance {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 24px;
            font-weight: 700;
            color: #ffffff;
        }
        
        .gem-icon {
            color: #ff4757;
            font-size: 20px;
        }
        
        /* Button Styles */
        .action-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }
        
        .btn {
            padding: 14px;
            border-radius: 12px;
            border: none;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.3s ease;
        }
        
        .btn:active {
            transform: scale(0.98);
        }
        
        .btn-topup {
            background: linear-gradient(135deg, #00b894 0%, #00a085 100%);
            color: white;
        }
        
        .btn-transfer {
            background: linear-gradient(135deg, #0984e3 0%, #0066cc 100%);
            color: white;
        }
        
        /* Shop Section */
        .shop-section {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .section-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 20px;
            color: #ffffff;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-title i {
            color: #fdcb6e;
        }
        
        .shop-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
        }
        
        .shop-item {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            padding: 16px 8px;
            text-align: center;
            position: relative;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .shop-item:active {
            transform: scale(0.95);
            background: rgba(255, 255, 255, 0.15);
        }
        
        .shop-item.available {
            border-color: rgba(253, 203, 110, 0.3);
        }
        
        .shop-icon {
            font-size: 26px;
            margin-bottom: 8px;
            color: #a29bfe;
        }
        
        .shop-item.available .shop-icon {
            color: #fdcb6e;
        }
        
        .shop-name {
            font-size: 12px;
            font-weight: 500;
            line-height: 1.3;
        }
        
        .soon-badge {
            position: absolute;
            top: -6px;
            right: -6px;
            background: #e17055;
            color: white;
            font-size: 10px;
            font-weight: 600;
            padding: 3px 6px;
            border-radius: 6px;
            transform: rotate(15deg);
        }
        
        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(26, 26, 46, 0.95);
            backdrop-filter: blur(20px);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding: 10px 20px;
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            z-index: 1000;
        }
        
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            padding: 8px 4px;
            border-radius: 10px;
            transition: all 0.3s ease;
            color: rgba(255, 255, 255, 0.6);
            text-decoration: none;
        }
        
        .nav-item.active {
            color: #00b894;
            background: rgba(0, 184, 148, 0.1);
        }
        
        .nav-item i {
            font-size: 20px;
        }
        
        .nav-label {
            font-size: 11px;
            font-weight: 500;
        }
        
        /* Animation for new item */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .highlight {
            animation: pulse 2s infinite;
        }
        
        /* Responsive */
        @media (max-width: 400px) {
            .container {
                padding: 15px;
            }
            
            .shop-grid {
                gap: 12px;
            }
            
            .shop-item {
                padding: 14px 6px;
            }
            
            .nav-label {
                font-size: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- User Header -->
        <div class="user-header">
            <div class="user-info">
                <div class="user-name" id="userName">Minh Quyên</div>
                <div class="balance">
                    <i class="fas fa-gem gem-icon"></i>
                    <span id="userBalance">0.00</span>
                </div>
            </div>
            
            <div class="action-buttons">
                <button class="btn btn-topup" id="topupBtn">
                    <i class="fas fa-coins"></i>
                    Nạp tiền
                </button>
                <button class="btn btn-transfer" id="transferBtn">
                    <i class="fas fa-exchange-alt"></i>
                    Chuyển tiền
                </button>
            </div>
        </div>
        
        <!-- Shop Section -->
        <div class="shop-section">
            <div class="section-title">
                <i class="fas fa-store"></i>
                Cửa Hàng
            </div>
            
            <div class="shop-grid" id="shopGrid">
                <!-- Shop items will be loaded by JavaScript -->
            </div>
        </div>
        
        <!-- More sections can be added here -->
    </div>
    
    <!-- Bottom Navigation -->
    <div class="bottom-nav">
        <a href="#" class="nav-item active" data-page="home">
            <i class="fas fa-home"></i>
            <span class="nav-label">Trang chủ</span>
        </a>
        <a href="#" class="nav-item" data-page="earn">
            <i class="fas fa-money-bill-wave"></i>
            <span class="nav-label">Kiếm tiền</span>
        </a>
        <a href="#" class="nav-item" data-page="history">
            <i class="fas fa-history"></i>
            <span class="nav-label">Lịch sử</span>
        </a>
        <a href="#" class="nav-item" data-page="account">
            <i class="fas fa-user"></i>
            <span class="nav-label">Tài khoản</span>
        </a>
    </div>
    
    <script>
        // Telegram WebApp Initialization
        const tg = window.Telegram.WebApp;
        
        // Initialize the app
        document.addEventListener('DOMContentLoaded', () => {
            // Expand to full screen
            tg.expand();
            
            // Set theme colors based on Telegram
            if (tg.themeParams.bg_color) {
                document.body.style.background = tg.themeParams.bg_color;
            }
            
            // Get user data from Telegram
            const initData = tg.initDataUnsafe;
            if (initData.user) {
                const user = initData.user;
                document.getElementById('userName').textContent = 
                    user.first_name || user.username || 'Người dùng';
                
                // You can get user ID for backend calls
                console.log('Telegram User ID:', user.id);
            }
            
            // Ready to show app
            tg.ready();
            
            // Initialize app data
            initializeApp();
        });
        
        // App Data and Functions
        function initializeApp() {
            // User data
            let userBalance = 0.00;
            
            // Shop items data
            const shopItems = [
                { id: 1, name: "GPM Key", icon: "key", color: "#fdcb6e", available: true },
                { id: 2, name: "Proxy", icon: "server", color: "#a29bfe", available: false },
                { id: 3, name: "Facebook", icon: "facebook", color: "#74b9ff", available: false },
                { id: 4, name: "Telegram", icon: "paper-plane", color: "#74b9ff", available: false },
                { id: 5, name: "Mobile", icon: "mobile-alt", color: "#55efc4", available: false },
                { id: 6, name: "VPS", icon: "cloud", color: "#dfe6e9", available: false },
                { id: 7, name: "Music", icon: "music", color: "#fd79a8", available: false },
                { id: 8, name: "Email", icon: "envelope", color: "#ffeaa7", available: false },
                { id: 9, name: "Software", icon: "code", color: "#00cec9", available: false },
                { id: 10, name: "Education", icon: "graduation-cap", color: "#6c5ce7", available: false },
                { id: 11, name: "Code", icon: "file-code", color: "#00b894", available: false },
                { id: 12, name: "Tương tác", icon: "users", color: "#fab1a0", available: false }
            ];
            
            // Load shop items
            loadShopItems(shopItems);
            
            // Setup event listeners
            setupEventListeners();
        }
        
        function loadShopItems(items) {
            const shopGrid = document.getElementById('shopGrid');
            shopGrid.innerHTML = '';
            
            items.forEach(item => {
                const shopItem = document.createElement('div');
                shopItem.className = `shop-item ${item.available ? 'available' : ''}`;
                shopItem.dataset.id = item.id;
                
                // Icon mapping
                const iconMap = {
                    'key': 'key',
                    'server': 'server',
                    'facebook': 'facebook-f',
                    'paper-plane': 'paper-plane',
                    'mobile-alt': 'mobile-alt',
                    'cloud': 'cloud',
                    'music': 'music',
                    'envelope': 'envelope',
                    'code': 'code',
                    'graduation-cap': 'graduation-cap',
                    'file-code': 'file-code',
                    'users': 'users'
                };
                
                shopItem.innerHTML = `
                    <i class="fas fa-${iconMap[item.icon] || 'question-circle'} shop-icon"></i>
                    <div class="shop-name">${item.name}</div>
                    ${!item.available ? '<div class="soon-badge">Soon</div>' : ''}
                `;
                
                // Add click event
                shopItem.addEventListener('click', () => {
                    if (item.available) {
                        openProduct(item);
                    } else {
                        showComingSoon(item.name);
                    }
                });
                
                shopGrid.appendChild(shopItem);
            });
        }
        
        function setupEventListeners() {
            // Top up button
            document.getElementById('topupBtn').addEventListener('click', () => {
                tg.showPopup({
                    title: 'Nạp tiền',
                    message: 'Chọn phương thức nạp tiền:',
                    buttons: [
                        { id: 'momo', type: 'default', text: 'Momo' },
                        { id: 'bank', type: 'default', text: 'Chuyển khoản' },
                        { id: 'crypto', type: 'default', text: 'Crypto' },
                        { type: 'cancel' }
                    ]
                }, (buttonId) => {
                    if (buttonId) {
                        tg.showAlert(`Đã chọn: ${buttonId}`);
                    }
                });
            });
            
            // Transfer button
            document.getElementById('transferBtn').addEventListener('click', () => {
                tg.showPopup({
                    title: 'Chuyển tiền',
                    message: 'Tính năng sẽ có sớm!',
                    buttons: [{ type: 'ok' }]
                });
            });
            
            // Bottom navigation
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', (e) => {
                    e.preventDefault();
                    const page = item.dataset.page;
                    
                    // Remove active class from all
                    document.querySelectorAll('.nav-item').forEach(nav => {
                        nav.classList.remove('active');
                    });
                    
                    // Add active to clicked
                    item.classList.add('active');
                    
                    // Handle page switching
                    switchPage(page);
                });
            });
        }
        
        function openProduct(product) {
            tg.showPopup({
                title: product.name,
                message: `Bạn muốn mua ${product.name}?`,
                buttons: [
                    { id: 'buy', type: 'default', text: 'Mua ngay' },
                    { type: 'cancel' }
                ]
            }, (buttonId) => {
                if (buttonId === 'buy') {
                    tg.showAlert(`Đã mua thành công ${product.name}!`);
                }
            });
        }
        
        function showComingSoon(productName) {
            tg.showPopup({
                title: 'Sắp có!',
                message: `${productName} sẽ có sớm. Vui lòng quay lại sau!`,
                buttons: [{ type: 'ok' }]
            });
        }
        
        function switchPage(page) {
            // For now, just show alert
            const pageNames = {
                'home': 'Trang chủ',
                'earn': 'Kiếm tiền',
                'history': 'Lịch sử',
                'account': 'Tài khoản'
            };
            
            tg.showAlert(`Chuyển đến trang: ${pageNames[page]}`);
            
            // In a real app, you would load different content here
            // Example: fetchPageContent(page);
        }
        
        // Back button handling
        tg.BackButton.onClick(() => {
            // Handle back button press
            tg.showConfirm('Bạn có muốn đóng ứng dụng?', (confirmed) => {
                if (confirmed) {
                    tg.close();
                }
            });
        });
    </script>
</body>
</html>
